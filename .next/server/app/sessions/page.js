(()=>{var e={};e.id=496,e.ids=[496],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},76942:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>i.a,__next_app__:()=>m,originalPathname:()=>x,pages:()=>d,routeModule:()=>h,tree:()=>c});var a=t(67096),n=t(16132),r=t(37284),i=t.n(r),l=t(32564),o={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>l[e]);t.d(s,o);let c=["",{children:["sessions",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,80425)),"/Users/hector.jaraba/Proyects/cursor-planning-poker/src/app/sessions/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,7389)),"/Users/hector.jaraba/Proyects/cursor-planning-poker/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,9291,23)),"next/dist/client/components/not-found-error"]}],d=["/Users/hector.jaraba/Proyects/cursor-planning-poker/src/app/sessions/page.tsx"],x="/sessions/page",m={require:t,loadChunk:()=>Promise.resolve()},h=new a.AppPageRouteModule({definition:{kind:n.x.APP_PAGE,page:"/sessions/page",pathname:"/sessions",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},54092:(e,s,t)=>{Promise.resolve().then(t.bind(t,94157))},94157:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>SessionsPage});var a=t(30784),n=t(9885),r=t(57114),i=t(74284),l=t(11440),o=t.n(l),c=t(56641);function LoadingSpirit(){return(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center",children:[(0,a.jsxs)("div",{className:"relative h-16 w-16",children:[(0,a.jsxs)("div",{className:"absolute inset-0 animate-float",children:[a.jsx("div",{className:"h-full w-full rounded-full bg-gradient-to-b from-purple-400/30 to-blue-400/30 blur-sm"}),a.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:a.jsx("div",{className:"h-8 w-8 rounded-full bg-white/20"})})]}),a.jsx("div",{className:"absolute -bottom-4 left-1/2 h-4 w-4 -translate-x-1/2 animate-trail",children:a.jsx("div",{className:"h-full w-full rounded-full bg-primary-400"})})]}),a.jsx("div",{className:"mt-4 text-sm text-gray-400 animate-pulse",children:"Loading..."})]})}function SessionsPage(){let e=(0,r.useRouter)(),{data:s,status:t}=(0,i.useSession)(),[l,d]=(0,n.useState)([]),[x,m]=(0,n.useState)(!0),[h,u]=(0,n.useState)(""),[p,g]=(0,n.useState)(null);(0,n.useEffect)(()=>{"unauthenticated"===t&&e.push("/auth/signin?callbackUrl=/sessions")},[t,e]),(0,n.useEffect)(()=>{"authenticated"===t&&(m(!0),console.log("Auth status is authenticated, fetching sessions"),fetchSessions())},[t]);let fetchSessions=async()=>{try{let e=await fetch("/api/sessions");if(!e.ok){let s=await e.json();throw console.error("API Error:",s),Error(s.error||"Failed to fetch sessions")}let s=await e.json();d(s)}catch(e){console.error("Error fetching sessions:",e),u(e instanceof Error?e.message:"Failed to fetch sessions")}finally{m(!1)}},handleDeleteSession=async e=>{try{let s=await fetch(`/api/sessions/${e}`,{method:"DELETE"});if(!s.ok){let e=await s.json();throw Error(e.message||"Failed to delete session")}d(s=>s.filter(s=>s._id!==e)),g(null)}catch(e){console.error("Error deleting session:",e),u(e instanceof Error?e.message:"Failed to delete session")}};return"loading"===t||"unauthenticated"===t?a.jsx("div",{className:"flex min-h-screen items-center justify-center bg-gray-900",children:a.jsx(LoadingSpirit,{})}):(0,a.jsxs)(a.Fragment,{children:[a.jsx(c.Z,{}),(0,a.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,a.jsxs)("div",{className:"mb-8 flex flex-col justify-between gap-4 sm:flex-row sm:items-center",children:[a.jsx("h1",{className:"text-3xl font-bold text-white",children:"My Sessions"}),(0,a.jsxs)("div",{className:"flex gap-4",children:[a.jsx(o(),{href:"/sessions/create",className:"btn btn-primary",children:"Create New Session"}),a.jsx(o(),{href:"/sessions/join",className:"btn btn-secondary",children:"Join Session"})]})]}),x?a.jsx("div",{className:"flex min-h-[400px] items-center justify-center",children:a.jsx(LoadingSpirit,{})}):h?(0,a.jsxs)("div",{className:"rounded-lg bg-red-500 p-4 text-white",children:["Error: ",h]}):0===l.length?(0,a.jsxs)("div",{className:"rounded-lg bg-gray-800 p-8 text-center",children:[a.jsx("h2",{className:"mb-4 text-xl font-semibold text-white",children:"No sessions found"}),a.jsx("p",{className:"mb-6 text-gray-300",children:"Create a new session or join an existing one."}),(0,a.jsxs)("div",{className:"flex flex-col gap-4 sm:flex-row sm:justify-center",children:[a.jsx(o(),{href:"/sessions/create",className:"btn btn-primary",children:"Create Session"}),a.jsx(o(),{href:"/sessions/join",className:"btn btn-secondary",children:"Join Session"})]})]}):a.jsx("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:l.map(e=>(0,a.jsxs)("div",{className:"rounded-lg bg-gray-800 p-6 shadow-md transition-transform hover:scale-[1.02]",children:[(0,a.jsxs)("div",{className:"mb-4 flex items-start justify-between",children:[a.jsx("h2",{className:"text-xl font-semibold text-white",children:e.name}),e.ownerId===s?.user?.id&&a.jsx("button",{onClick:()=>g(e._id),className:"text-red-500 hover:text-red-400",title:"Delete session",children:a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:a.jsx("path",{fillRule:"evenodd",d:"M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z",clipRule:"evenodd"})})})]}),(0,a.jsxs)("div",{className:"mb-4 flex flex-wrap gap-3",children:[a.jsx("span",{className:`badge ${"active"===e.status?"bg-lime-500 text-white":"bg-gray-600 text-white"} px-3 py-1 text-sm font-medium`,children:"active"===e.status?"In Progress":"Completed"}),a.jsx("span",{className:"badge badge-primary",children:"fibonacci"===e.estimationType?"Fibonacci":"T-Shirt Sizes"}),e.tasks.length>0&&(0,a.jsxs)("span",{className:"badge badge-info",children:[e.tasks.filter(e=>"completed"===e.status).length," ","/ ",e.tasks.length," Completed"]})]}),(0,a.jsxs)("div",{className:"mb-4 text-sm text-gray-400",children:["Created:"," ",e.createdAt&&!isNaN(new Date(e.createdAt).getTime())?new Date(e.createdAt).toLocaleString():"Recently created"]}),a.jsx(o(),{href:`/sessions/${e._id}`,className:"btn btn-primary w-full",children:"Open Session"})]},e._id))})]}),p&&a.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:(0,a.jsxs)("div",{className:"rounded-lg bg-gray-800 p-6 shadow-xl",children:[a.jsx("h3",{className:"mb-4 text-xl font-semibold text-white",children:"Delete Session"}),a.jsx("p",{className:"mb-6 text-gray-300",children:"Are you sure you want to delete this session? This action cannot be undone."}),(0,a.jsxs)("div",{className:"flex justify-end gap-4",children:[a.jsx("button",{onClick:()=>g(null),className:"btn btn-secondary",children:"Cancel"}),a.jsx("button",{onClick:()=>handleDeleteSession(p),className:"btn btn-danger",children:"Delete"})]})]})})]})}},80425:(e,s,t)=>{"use strict";t.r(s),t.d(s,{$$typeof:()=>i,__esModule:()=>r,default:()=>o});var a=t(95153);let n=(0,a.createProxy)(String.raw`/Users/hector.jaraba/Proyects/cursor-planning-poker/src/app/sessions/page.tsx`),{__esModule:r,$$typeof:i}=n,l=n.default,o=l}};var s=require("../../webpack-runtime.js");s.C(e);var __webpack_exec__=e=>s(s.s=e),t=s.X(0,[657,930,440,451,726,641],()=>__webpack_exec__(76942));module.exports=t})();