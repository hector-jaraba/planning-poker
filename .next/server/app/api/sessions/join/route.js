"use strict";(()=>{var e={};e.id=694,e.ids=[694],e.modules={58802:e=>{e.exports=require("bcrypt")},38013:e=>{e.exports=require("mongodb")},11185:e=>{e.exports=require("mongoose")},72934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},39491:e=>{e.exports=require("assert")},14300:e=>{e.exports=require("buffer")},6113:e=>{e.exports=require("crypto")},82361:e=>{e.exports=require("events")},13685:e=>{e.exports=require("http")},95687:e=>{e.exports=require("https")},63477:e=>{e.exports=require("querystring")},57310:e=>{e.exports=require("url")},73837:e=>{e.exports=require("util")},59796:e=>{e.exports=require("zlib")},12306:(e,s,r)=>{r.r(s),r.d(s,{headerHooks:()=>m,originalPathname:()=>y,requestAsyncStorage:()=>q,routeModule:()=>x,serverHooks:()=>g,staticGenerationAsyncStorage:()=>j,staticGenerationBailout:()=>h});var t={};r.r(t),r.d(t,{POST:()=>POST}),r(78976);var i=r(10884),o=r(16132),n=r(95798),a=r(94020),u=r(24685),p=r(92067),c=r(9919),d=r(11185),l=r.n(d);async function POST(e){try{let s;let r=await (0,a.getServerSession)(u.authOptions);if(!r||!r.user)return n.Z.json({message:"Unauthorized"},{status:401});await (0,c.$)();let t=await e.json(),{sessionId:i}=t;if(!i)return n.Z.json({message:"Session ID or share link is required"},{status:400});if(l().Types.ObjectId.isValid(i)&&(s=await p.Z.findById(i)),s||(s=await p.Z.findOne({shareLink:i})),!s)return n.Z.json({message:"Session not found"},{status:404});let o=r.user.id;return s.participants.includes(o)||(s.participants.push(o),await s.save()),n.Z.json({_id:s._id,name:s.name})}catch(e){return console.error("Failed to join session:",e),n.Z.json({message:"Failed to join session"},{status:500})}}let x=new i.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/sessions/join/route",pathname:"/api/sessions/join",filename:"route",bundlePath:"app/api/sessions/join/route"},resolvedPagePath:"/Users/hector.jaraba/Proyects/cursor-planning-poker/src/app/api/sessions/join/route.ts",nextConfigOutput:"standalone",userland:t}),{requestAsyncStorage:q,staticGenerationAsyncStorage:j,serverHooks:g,headerHooks:m,staticGenerationBailout:h}=x,y="/api/sessions/join/route"}};var s=require("../../../../webpack-runtime.js");s.C(e);var __webpack_exec__=e=>s(s.s=e),r=s.X(0,[657,199,798,960,20,919,685,67],()=>__webpack_exec__(12306));module.exports=r})();