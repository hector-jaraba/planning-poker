(()=>{var e={};e.id=969,e.ids=[969],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},65731:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>i.a,__next_app__:()=>p,originalPathname:()=>u,pages:()=>d,routeModule:()=>m,tree:()=>c});var n=t(67096),r=t(16132),o=t(37284),i=t.n(o),a=t(32564),l={};for(let e in a)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>a[e]);t.d(s,l);let c=["",{children:["sessions",{children:["join",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,45959)),"/Users/hector.jaraba/Proyects/cursor-planning-poker/src/app/sessions/join/page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,7389)),"/Users/hector.jaraba/Proyects/cursor-planning-poker/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,9291,23)),"next/dist/client/components/not-found-error"]}],d=["/Users/hector.jaraba/Proyects/cursor-planning-poker/src/app/sessions/join/page.tsx"],u="/sessions/join/page",p={require:t,loadChunk:()=>Promise.resolve()},m=new n.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/sessions/join/page",pathname:"/sessions/join",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},92361:(e,s,t)=>{Promise.resolve().then(t.bind(t,66560))},66560:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>JoinSession});var n=t(30784),r=t(9885),o=t(57114),i=t(74284),a=t(56641);function JoinSession(){let e=(0,o.useRouter)(),s=(0,o.useSearchParams)(),{status:t}=(0,i.useSession)(),[l,c]=(0,r.useState)(""),[d,u]=(0,r.useState)(!1),[p,m]=(0,r.useState)(""),[x,h]=(0,r.useState)(!1);if((0,r.useEffect)(()=>{if("authenticated"===t&&s&&!x){let e=s.get("code");if(e){console.log("Found session code in URL:",e),c(e),h(!0);let s=setTimeout(()=>{joinSession(e)},300);return()=>clearTimeout(s)}}},[s,t,x]),(0,r.useEffect)(()=>{"unauthenticated"===t&&e.push(`/auth/signin?callbackUrl=${encodeURIComponent("/sessions/join")}`)},[t,e]),"unauthenticated"===t)return null;let joinSession=async s=>{if(!s.trim()){m("Session link is required");return}u(!0),m("");try{let t;if(s.includes("/"))try{let e=new URL(s),n=e.pathname.split("/");t=n[n.length-1];let r=new URLSearchParams(e.search),o=r.get("code");o&&(t=o)}catch(e){t=s}else t=s;console.log("Joining session with ID:",t);let n=await fetch("/api/sessions/join",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sessionId:t})}),r=await n.json();if(!n.ok)throw Error(r.message||"Failed to join session");console.log("Successfully joined session, redirecting to:",r._id),e.push(`/sessions/${r._id}`)}catch(e){console.error("Error joining session:",e),m(e instanceof Error?e.message:"An error occurred"),u(!1)}},handleSubmit=async e=>{e.preventDefault(),await joinSession(l)};return(0,n.jsxs)(n.Fragment,{children:[n.jsx(a.Z,{}),n.jsx("div",{className:"container mx-auto px-4 py-8",children:(0,n.jsxs)("div",{className:"mx-auto max-w-lg",children:[n.jsx("h1",{className:"mb-6 text-center text-3xl font-bold text-white",children:"Join a Session"}),p&&n.jsx("div",{className:"mb-4 rounded-md bg-red-500 p-3 text-white",children:p}),(0,n.jsxs)("form",{onSubmit:handleSubmit,className:"rounded-lg bg-gray-800 p-6 shadow-md",children:[(0,n.jsxs)("div",{className:"mb-6",children:[n.jsx("label",{htmlFor:"sessionLink",className:"mb-2 block text-sm font-medium text-gray-300",children:"Session Link or Code"}),n.jsx("input",{type:"text",id:"sessionLink",className:"input input-bordered w-full",value:l,onChange:e=>c(e.target.value),placeholder:"Enter session code",required:!0,disabled:d})]}),n.jsx("button",{type:"submit",className:`btn btn-primary w-full ${d?"loading":""}`,disabled:d,children:d?"Joining...":"Join Session"})]})]})})]})}},45959:(e,s,t)=>{"use strict";t.r(s),t.d(s,{$$typeof:()=>i,__esModule:()=>o,default:()=>l});var n=t(95153);let r=(0,n.createProxy)(String.raw`/Users/hector.jaraba/Proyects/cursor-planning-poker/src/app/sessions/join/page.tsx`),{__esModule:o,$$typeof:i}=r,a=r.default,l=a}};var s=require("../../../webpack-runtime.js");s.C(e);var __webpack_exec__=e=>s(s.s=e),t=s.X(0,[657,930,440,451,726,641],()=>__webpack_exec__(65731));module.exports=t})();